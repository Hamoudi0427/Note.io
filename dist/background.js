(()=>{var e,t;console.log("This is the background script"),chrome.webRequest.onBeforeSendHeaders.addListener((function(t){try{var o=t.requestHeaders;o=o.filter((function(e){return"Authorization"===e.name})),e=o[0].value,chrome.storage.local.set({AuthToken:e},(function(){}))}catch(e){console.log(e)}}),{urls:["https://graph.microsoft.com/v1.0/*"]},["requestHeaders"]),chrome.runtime.onMessage.addListener((function(e,o,n){"getCurrentTab"===e.action&&(n(o.url),t=(t=o.url.substring(o.url.indexOf("v="),o.url.length)).split("=")[1],chrome.storage.local.set({videoID:t},(function(){})))})),chrome.tabs.onActivated.addListener((function(e,o){console.log("tab changed"),chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(e){var o=e[0].url;e[0].title,o.includes("youtube")&&(console.log(o),t=(t=o.substring(o.indexOf("v="),o.length)).split("=")[1],chrome.storage.local.set({videoID:t},(function(){})))}))})),chrome.tabs.onUpdated.addListener((function(e,o,n){o.url&&(t=(t=o.url.substring(o.url.indexOf("v="),o.url.length)).split("=")[1],chrome.storage.local.set({videoID:t},(function(){}))),o.title&&console.log(o.title)}))})();